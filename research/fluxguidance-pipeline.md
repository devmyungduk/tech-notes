## ⚙️ FluxGuidance Pipeline

FluxGuidance는 텍스트 인코더와 ControlNet 간의 상호작용을 통해 생성 과정을 제어하는 확장 구조입니다.

---

## 🔸 Pipeline A: Text Guidance First

```
Text Encoder → FluxGuidance → ControlNet → Sampler
```

- 텍스트 조건을 먼저 해석하여, 이후 ControlNet의 구조적 제약보다 높은 우선순위를 부여합니다.
- 적합: 스타일 / 감성 기반 생성, 문체 일관성 유지가 중요한 경우.

---

## 🔹 Pipeline B: ControlNet First

```
Text Encoder → ControlNet → FluxGuidance → Sampler
```

- 공간적 / 구조적 조건(Control)을 우선적으로 반영합니다.
- 적합: 레이아웃, 포즈, 깊이 기반 제어 등 정확한 구조가 필요한 경우.

---

## 🔸 비교 요약

| 항목 | Pipeline A | Pipeline B |
|:-----|:------------|:------------|
| 텍스트 반영 강도 | 높음 | 중간 |
| 구조 제어 정확도 | 낮음 | 높음 |
| 적용 사례 | 스타일, 분위기 | 구도, 형태 |
| 장점 | 감성 표현 우수 | 구조적 일관성 |
| 단점 | 제어 불안정 가능성 | 텍스트 표현 감소 |

---

## 🧩 결론
FluxGuidance는 **텍스트 중심**과 **구조 중심** 파이프라인 사이의 균형을 조정할 수 있는 유연한 모듈로,  
실험 목적에 따라 입력 순서를 바꾸는 것만으로도 전혀 다른 생성 결과를 유도할 수 있습니다.


## 🎛️ FluxGuidance 파이프라인 비교

## 🧩 1️⃣ `text encode → FluxGuidance → ControlNet → Sampler`

```
┌────────────────────────────────────────────┐
│                파이프라인 ①                │
│ text encode → FluxGuidance → ControlNet → Sampler │
└────────────────────────────────────────────┘

[텍스트 인코딩 단계]
┌────────────────────────────────────────────┐
│ text encoder                               │
│ └─ 텍스트 프롬프트("a cat in a space suit")를 벡터로 변환 │
└────────────────────────────────────────────┘
                     │
                     ▼
[FluxGuidance 적용]
┌────────────────────────────────────────────┐
│ FluxGuidance                              │
│ └─ 텍스트 기반 conditioning 강도 조절       │
│    (프롬프트의 의미 강조 / 중요도 가중)     │
└────────────────────────────────────────────┘
                     │
                     ▼
[ControlNet 적용]
┌────────────────────────────────────────────┐
│ ControlNet                                │
│ └─ 이미지 힌트(예: 포즈, 깊이, 라인 등)와 결합 │
│    단, 텍스트 영향이 우선됨                 │
└────────────────────────────────────────────┘
                     │
                     ▼
[Sampling 단계]
┌────────────────────────────────────────────┐
│ Sampler                                   │
│ └─ 조절된 텍스트 조건을 기반으로 이미지 생성 │
└────────────────────────────────────────────┘

📈 **효과**
- FluxGuidance가 **텍스트 프롬프트에만 적용**
- ControlNet보다 **텍스트 조건이 더 강하게 반영**
- 텍스트 강조나 문장 의미 표현이 약할 때 적합
```

---

## 🧩 2️⃣ `text encode → ControlNet → FluxGuidance → Sampler`

```
┌────────────────────────────────────────────┐
│                파이프라인 ②                │
│ text encode → ControlNet → FluxGuidance → Sampler │
└────────────────────────────────────────────┘

[텍스트 인코딩 단계]
┌────────────────────────────────────────────┐
│ text encoder                               │
│ └─ 텍스트 프롬프트를 벡터로 변환             │
└────────────────────────────────────────────┘
                     │
                     ▼
[ControlNet 적용]
┌────────────────────────────────────────────┐
│ ControlNet                                │
│ └─ 텍스트 + 이미지 힌트 결합                │
│    (예: 구도, 깊이, 엣지 정보 등)           │
└────────────────────────────────────────────┘
                     │
                     ▼
[FluxGuidance 적용]
┌────────────────────────────────────────────┐
│ FluxGuidance                              │
│ └─ 통합된 조건(텍스트+ControlNet)을 조절     │
│    전체 컨디션의 강약 조절에 작용           │
└────────────────────────────────────────────┘
                     │
                     ▼
[Sampling 단계]
┌────────────────────────────────────────────┐
│ Sampler                                   │
│ └─ 통합된 조건에 따라 최종 이미지 생성       │
└────────────────────────────────────────────┘

📈 **효과**
- FluxGuidance가 **텍스트 + ControlNet 조건 전체에 작용**
- 텍스트만 따로 조절하기엔 덜 정밀하지만,
- 전체 조건을 **균형 있게 강화하거나 완화**할 때 적합
```

---

## 비교 요약

| 구분                                                  | FluxGuidance 적용 대상 | 효과           | 권장 상황                        |
| --------------------------------------------------- | ------------------ | ------------ | ---------------------------- |
| `text encode → FluxGuidance → ControlNet → Sampler` | 텍스트 프롬프트만          | 텍스트 의미를 강조   | 텍스트가 그림에서 약하게 드러날 때          |
| `text encode → ControlNet → FluxGuidance → Sampler` | 텍스트 + 이미지 조건 전체    | 전체 조건의 강도 조절 | ControlNet 힌트와 텍스트를 함께 조율할 때 |

---

## ⚙️ 추가 팁

* `FluxGuidance`는 **강도(float)** 로 조절 (일반적으로 `1.0 ~ 7.5`)
* `>15` 이상은 과도하게 강한 조건이 될 수 있으므로 주의
* 고급 구성: 텍스트 조건용과 ControlNet 조건용으로 **두 개의 FluxGuidance 노드 분리** 가능
